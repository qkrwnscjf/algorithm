# 2021년에 가입한 회원의 구매 활동 분석

## 문제 설명

다음은 어느 의류 쇼핑몰에 가입한 회원 정보를 담은 `USER_INFO` 테이블과  
온라인 상품 판매 정보를 담은 `ONLINE_SALE` 테이블에 관한 문제입니다.

### USER_INFO 테이블

| Column name | Type         | Nullable |
|-------------|--------------|----------|
| USER_ID     | INTEGER      | FALSE    |
| GENDER      | TINYINT(1)   | TRUE     |
| AGE         | INTEGER      | TRUE     |
| JOINED      | DATE         | FALSE    |

- `GENDER`는 NULL, 0, 1 중 하나의 값을 가지며, 0은 남성, 1은 여성을 의미합니다.

### ONLINE_SALE 테이블

| Column name     | Type    | Nullable |
|------------------|---------|----------|
| ONLINE_SALE_ID   | INTEGER | FALSE    |
| USER_ID          | INTEGER | FALSE    |
| PRODUCT_ID       | INTEGER | FALSE    |
| SALES_AMOUNT     | INTEGER | FALSE    |
| SALES_DATE       | DATE    | FALSE    |

- 동일한 날짜, 회원 ID, 상품 ID 조합에 대해서는 하나의 판매 데이터만 존재합니다.

---

## 문제

`USER_INFO` 테이블과 `ONLINE_SALE` 테이블에서 **2021년에 가입한 전체 회원** 중  
**상품을 구매한 회원 수**와 **상품을 구매한 회원의 비율**을  
**연도(YYYY), 월(MM)** 단위로 조회하는 SQL문을 작성하세요.

- 비율은 `2021년에 가입한 회원 중 구매한 회원 수 / 전체 2021년 가입자 수`입니다.
- 상품을 구매한 회원의 비율은 **소수점 둘째 자리에서 반올림**합니다.
- 결과는 `YEAR`, `MONTH` 순으로 **오름차순 정렬**해야 합니다.

---

## 출력 예시

USER_INFO 테이블:

| USER_ID | GENDER | AGE | JOINED     |
|---------|--------|-----|------------|
| 1       | 1      | 26  | 2021-06-01 |
| 2       | NULL   | NULL| 2021-06-25 |
| 3       | 0      | NULL| 2021-06-30 |
| 4       | 0      | 31  | 2021-07-03 |
| 5       | 1      | 25  | 2022-01-09 |
| 6       | 1      | 33  | 2022-02-14 |

ONLINE_SALE 테이블:

| ONLINE_SALE_ID | USER_ID | PRODUCT_ID | SALES_AMOUNT | SALES_DATE |
|----------------|---------|------------|---------------|-------------|
| 1              | 1       | 54         | 1             | 2022-01-01  |
| 2              | 1       | 3          | 2             | 2022-01-25  |
| 3              | 4       | 34         | 1             | 2022-01-30  |
| 4              | 6       | 253        | 3             | 2022-02-03  |
| 5              | 2       | 31         | 2             | 2022-02-09  |
| 6              | 5       | 35         | 1             | 2022-02-14  |
| 7              | 5       | 57         | 1             | 2022-02-18  |

2021년에 가입한 회원은 총 4명이며 (`USER_ID`: 1, 2, 3, 4),  
이 중 2022년에 구매한 회원은 `1, 2, 4`입니다.

---

### 최종 출력

| YEAR | MONTH | PURCHASED_USERS | PUCHASED_RATIO |
|------|-------|------------------|----------------|
| 2022 | 1     | 2                | 0.5            |
| 2022 | 2     | 1                | 0.3            |
