# 자동차 평균 대여 기간 조회 문제

## 📌 문제 설명

다음은 자동차 대여 회사의 자동차 대여 기록 정보를 담은 테이블입니다.  
해당 테이블을 이용해, **평균 대여 기간이 7일 이상인 자동차**들의 목록을 조회하는 SQL문을 작성합니다.

---

## 🗂 테이블 구조

### CAR_RENTAL_COMPANY_RENTAL_HISTORY

| 컬럼명     | 타입     | NULL 허용 | 설명               |
|------------|----------|------------|--------------------|
| HISTORY_ID | INTEGER  | FALSE      | 대여 기록 ID       |
| CAR_ID     | INTEGER  | FALSE      | 자동차 ID          |
| START_DATE | DATE     | FALSE      | 대여 시작일        |
| END_DATE   | DATE     | FALSE      | 대여 종료일        |

- 동일한 CAR_ID에 대해 여러 개의 대여 기록이 존재할 수 있습니다.
- 대여 기간은 `(END_DATE - START_DATE + 1)`로 계산합니다. (`+1`은 당일 포함)

---

## ❓ 문제 요구사항

- 각 자동차(CAR_ID)의 **평균 대여 기간**을 구합니다.
- **평균 대여 기간이 7일 이상인 자동차만** 추출합니다.
- 결과는 다음 컬럼을 포함해야 합니다:
  - `CAR_ID`
  - `AVERAGE_DURATION` (소수점 2번째 자리에서 반올림)
- 정렬 조건:
  1. 평균 대여 기간 기준 **내림차순**
  2. 평균 대여 기간이 같다면 **CAR_ID 기준 내림차순**

---

## 💡 예시

### 입력 예시

#### CAR_RENTAL_COMPANY_RENTAL_HISTORY

| HISTORY_ID | CAR_ID | START_DATE | END_DATE   |
|------------|--------|------------|------------|
| 1          | 1      | 2022-09-27 | 2022-10-01 |
| 2          | 1      | 2022-10-03 | 2022-11-04 |
| 3          | 2      | 2022-09-05 | 2022-09-05 |
| 4          | 2      | 2022-09-08 | 2022-09-10 |
| 5          | 3      | 2022-09-16 | 2022-10-15 |
| 6          | 1      | 2022-11-07 | 2022-12-06 |

---

### 🔍 계산

#### 자동차 ID = 1  
- 2022-09-27 ~ 2022-10-01: 5일  
- 2022-10-03 ~ 2022-11-04: 33일  
- 2022-11-07 ~ 2022-12-06: 30일  
→ 평균: (5 + 33 + 30) / 3 = **22.67**

#### 자동차 ID = 2  
- 2022-09-05 ~ 2022-09-05: 1일  
- 2022-09-08 ~ 2022-09-10: 3일  
→ 평균: (1 + 3) / 2 = **2.0**

#### 자동차 ID = 3  
- 2022-09-16 ~ 2022-10-15: 30일  
→ 평균: **30.0**

---

### ✅ 출력 예시

| CAR_ID | AVERAGE_DURATION |
|--------|------------------|
| 3      | 30.0             |
| 1      | 22.7             |
